<% layout('layout') %>

<!-- ✅ Make sure Bootstrap 5 is loaded in layout.ejs -->
<!-- Example: <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"> -->

<style>
  .product:hover {
    opacity: 0.5;
    background-color: whitesmoke;
  }

  .curved-border-card {
    border: none;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    border-radius: 12px;
    overflow: hidden;
    background: linear-gradient(135deg, #2c3e50, #34495e);
    padding: 3px;
  }

  .card-inner {
    background-color: white;
    height: 100%;
    padding: 5px;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
  }

  .wishlist-btn {
    background: rgba(255,255,255,0.8);
    transition: all 0.3s ease;
  }

  .wishlist-btn:hover {
    background: #ff6b6b;
    color: white;
  }

  .card-img-top {
    height: 140px;
    object-fit: contain;
    padding: 5px;
  }

  @media (max-width: 576px) {
    .card-img-top {
      height: 160px;
    }
  }
</style>

<div class="container mt-4">
  <!-- ✅ EXACTLY what you need: 2 cards on xs (mobile), 2 on sm, 3 on md, 4 on lg -->
  <div class="row row-cols-2 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3">
    <% products.forEach(product => { %>
      <div class="col">
        <div class="curved-border-card h-100">
          <div class="card-inner">
            <a href="/products/<%= product._id %>" class="text-decoration-none text-dark product">
              <div class="position-relative">
                <img src="<%= product.image %>" class="card-img-top" alt="<%= product.name %>">
                <div class="position-absolute top-0 start-0 m-1">
                  <form action="/wishlist/add/<%= product._id %>" method="POST">
                    <button type="submit" class="btn btn-sm wishlist-btn border rounded-circle">❤</button>
                  </form>
                </div>
              </div>
              <div class="card-body p-2">
                <h6 class="card-title text-truncate mb-1"><%= product.name %></h6>
                <p class="card-text small text-muted mb-2">
                  <b><%= product.title %></b>
                </p>
                <p class="card-text text-success fw-bold mb-1">₹ <%= product.price %></p>
              </div>
            </a>

            <div class="mt-auto">
              <div class="p-2 border-top bg-light rounded-bottom">
                <% if (currentUser) { %>
                  <!-- Add cart/order buttons here if needed -->
                <% } else { %>
                  <p class="text-muted small mb-1">Please <a href="/login">Login</a> to continue</p>
                <% } %>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
</div>

